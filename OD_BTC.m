%Function to generate OD-BTC
%Ref Paper:
% Improved block truncation coding based on the void-and-cluster dithering approach.
%Programmed By: Sankarasrinivasan S
%Multimedia Signal Processing Lab, Dept. of Elec Engg. NTUST
%Oct 2016
function [Y1]=OD_BTC(im,bs)

im=double(im);


[s1 s2]=size(im);
imd=zeros(s1,s2);
Y1=zeros(s1,s2);

if(bs==4)
coe=[0.666667,0.066667,0.866667,0.533333;
			0.800000,0.333333,0.733333,0.200000;
			0.400000,0.600000,0.133333,0.933333;
			0.000000,1.000000,0.466667,0.266667;];
elseif(bs==8)

coe= [0.301587,0.682540,0.476190,0.841270,0.571429,0.412698,0.238095,0.888889 ;
	  0.809524,0.095238,0.396825,0.904762,0.174603,0.730159,0.031746,0.603175 ;
	  0.158730,0.746032,0.222222,0.650794,0.317460,0.507937,0.984127,0.428571 ;
	  0.857143,0.492063,0.968254,0.047619,0.793651,0.126984,0.666667,0.349206;
	  0.063492,0.285714,0.587302,0.380952,0.460317,0.873016,0.253968,0.555556;
	  0.825397,0.714286,0.142857,0.920635,0.190476,0.698413,0.015873,0.936508;
	  0.206349,0.365079,0.634921,0.777778,0.523810,0.333333,0.619048,0.444444;
	  0.539683,1.000000,0.000000,0.269841,0.079365,0.952381,0.761905,0.111111;];

elseif(bs==16)
coe=[0.721569,0.058824,0.858824,0.447059,0.600000,0.831373,0.396078,0.945098,0.192157,0.894118,0.568627,0.745098,0.403922,0.627451,0.874510,0.48235;
     0.380392,0.639216,0.525490,0.156863,0.984314,0.329412,0.133333,0.498039,0.658824,0.368627,0.796078,0.054902,0.988235,0.223529,0.333333,0.113725 ;
	 0.937255,0.207843,0.788235,0.298039,0.070588,0.623529,0.760784,0.247059,0.854902,0.101961,0.270588,0.505882,0.172549,0.690196,0.811765,0.576471;
	 0.843137,0.015686,0.470588,0.925490,0.725490,0.439216,0.905882,0.027451,0.592157,0.450980,0.709804,0.901961,0.615686,0.419608,0.039216,0.262745;
	 0.427451,0.662745,0.341176,0.584314,0.227451,0.145098,0.537255,0.294118,0.980392,0.184314,0.827451,0.325490,0.109804,0.949020,0.541176,0.733333;
	 0.992157,0.168627,0.768627,0.098039,0.847059,0.678431,0.345098,0.784314,0.670588,0.384314,0.011765,0.494118,0.239216,0.776471,0.360784,0.117647;
	 0.619608,0.290196,0.890196,0.501961,0.392157,0.960784,0.062745,0.486275,0.121569,0.564706,0.929412,0.682353,0.588235,0.878431,0.200000,0.513725;
	 0.074510,0.407843,0.654902,0.035294,0.266667,0.556863,0.823529,0.211765,0.898039,0.282353,0.792157,0.164706,0.431373,0.047059,0.717647,0.839216;
	 0.478431,0.952941,0.180392,0.803922,0.729412,0.137255,0.647059,0.376471,0.741176,0.458824,0.086275,0.364706,0.972549,0.274510,0.635294,0.337255;
	 0.235294,0.686275,0.533333,0.313725,0.913725,0.454902,0.243137,0.976471,0.050980,0.611765,0.870588,0.549020,0.749020,0.462745,0.141176,0.921569;
	 0.007843,0.850980,0.090196,0.400000,0.596078,0.023529,0.862745,0.521569,0.176471,0.698039,0.317647,0.196078,0.031373,0.866667,0.580392,0.772549;
	 0.517647,0.278431,0.643137,0.996078,0.203922,0.705882,0.352941,0.780392,0.286275,0.423529,0.941176,0.800000,0.650980,0.349020,0.215686,0.411765;
	 0.933333,0.372549,0.764706,0.129412,0.819608,0.509804,0.082353,0.607843,0.886275,0.019608,0.560784,0.094118,0.490196,1.000000,0.105882,0.701961;
	 0.043137,0.188235,0.466667,0.572549,0.305882,0.415686,0.964706,0.152941,0.474510,0.752941,0.231373,0.388235,0.694118,0.258824,0.603922,0.815686;
	 0.552941,0.674510,0.882353,0.078431,0.917647,0.666667,0.254902,0.807843,0.321569,0.631373,0.956863,0.835294,0.160784,0.909804,0.435294,0.309804;
	 0.968627,0.250980,0.356863,0.737255,0.219608,0.003922,0.545098,0.713725,0.066667,0.443137,0.125490,0.301961,0.529412,0.000000,0.756863,0.149020;];
elseif(bs==32)
coe=[0.080156,0.778104,0.033236,0.942326,0.349951,0.704790,0.021505,0.960899,0.090909,0.169110,0.539589,0.974585,0.716520,0.266862,0.789834,0.173021,0.682307,0.584555,0.442815,0.253177,0.024438,0.731183,0.146628,0.444770,0.875855,0.187683,0.982405,0.703812,0.359726,0.907136,0.523949,0.261975;
	 0.869990,0.465298,0.614858,0.751711,0.110459,0.906158,0.276637,0.615836,0.478006,0.866080,0.659824,0.408602,0.152493,0.548387,0.036168,0.876833,0.277615,0.062561,0.753666,0.896383,0.507331,0.380254,0.971652,0.054741,0.625611,0.498534,0.094819,0.542522,0.243402,0.020528,0.413490,0.695015;
	 0.341153,0.137830,0.389052,0.224829,0.491691,0.589443,0.440860,0.835777,0.739003,0.223851,0.304985,0.085044,0.929619,0.755621,0.346041,0.629521,0.477028,0.979472,0.330401,0.189638,0.652004,0.271750,0.576735,0.820137,0.329423,0.747801,0.418377,0.834800,0.640274,0.775171,0.954057,0.206256;
	 0.530792,0.821114,0.975562,0.660802,0.861193,0.181818,0.058651,0.342131,0.122190,0.552297,0.895406,0.800587,0.489736,0.211144,0.428152,0.814272,0.130987,0.698925,0.553275,0.830890,0.088954,0.782991,0.462366,0.220919,0.951124,0.132942,0.270772,0.924731,0.175953,0.478983,0.107527,0.635386;
	 0.053763,0.712610,0.274682,0.016618,0.334311,0.799609,0.675464,0.983382,0.402737,0.694037,0.015640,0.367546,0.617791,0.700880,0.049853,0.913001,0.234604,0.376344,0.019550,0.435973,0.904203,0.163245,0.684262,0.014663,0.391984,0.657869,0.566960,0.039101,0.370479,0.600196,0.316716,0.892473;
	 0.404692,0.173998,0.567937,0.437928,0.900293,0.511241,0.254154,0.610948,0.199413,0.925709,0.463343,0.256109,0.127077,0.984360,0.311828,0.510264,0.604106,0.869013,0.741935,0.279570,0.612903,0.356794,0.934506,0.527859,0.734115,0.886608,0.459433,0.804497,0.718475,0.985337,0.251222,0.790811;
	 0.499511,0.921799,0.776149,0.637341,0.157380,0.077224,0.767351,0.434018,0.048876,0.785924,0.601173,0.855327,0.739980,0.547410,0.184751,0.779081,0.098729,0.453568,0.176931,0.969697,0.501466,0.111437,0.762463,0.291300,0.192571,0.070381,0.335288,0.230694,0.089932,0.521994,0.148583,0.671554;
	 0.343109,0.235582,0.102639,0.366569,0.965787,0.710655,0.352884,0.854350,0.529814,0.309873,0.165200,0.354839,0.079179,0.883675,0.399804,0.655914,0.932551,0.337243,0.686217,0.060606,0.797654,0.245357,0.582600,0.434995,0.827957,0.622678,0.928641,0.680352,0.849462,0.411535,0.880743,0.028348;
	 0.973607,0.546432,0.848485,0.464321,0.268817,0.572825,0.186706,0.944282,0.118280,0.724340,0.970674,0.519062,0.672532,0.267840,0.479961,0.037146,0.239492,0.575758,0.859238,0.406647,0.638319,0.885630,0.035191,0.986315,0.135875,0.537634,0.390029,0.164223,0.586510,0.303030,0.759531,0.613881;
	 0.151515,0.733138,0.057674,0.647116,0.807429,0.041056,0.487781,0.652981,0.278592,0.591398,0.433040,0.018573,0.822092,0.142717,0.958944,0.723363,0.810362,0.144673,0.526882,0.286413,0.191593,0.484848,0.364614,0.651026,0.308895,0.786901,0.023460,0.962854,0.485826,0.069404,0.217986,0.450635;
	 0.287390,0.409580,0.946237,0.333333,0.210166,0.919844,0.405670,0.823069,0.066471,0.872923,0.227761,0.748778,0.387097,0.611926,0.535679,0.297165,0.384164,0.987292,0.013685,0.695992,0.937439,0.075269,0.728250,0.862170,0.208211,0.472141,0.706745,0.259042,0.646139,0.795699,0.903226,0.685239;
	 0.825024,0.579668,0.129032,0.502444,0.758553,0.594330,0.140762,0.738025,0.325513,0.466276,0.133920,0.936461,0.307918,0.898338,0.195503,0.055718,0.642229,0.451613,0.765396,0.324536,0.824047,0.596285,0.263930,0.524927,0.097752,0.911046,0.361681,0.846530,0.117302,0.322581,0.538612,0.012708;
	 0.917889,0.231672,0.715543,0.867058,0.011730,0.375367,0.236559,0.525904,0.976540,0.696970,0.605083,0.515152,0.083089,0.735093,0.461388,0.793744,0.887586,0.219941,0.565982,0.155425,0.415445,0.115347,0.972630,0.396872,0.764418,0.618768,0.172043,0.561095,0.420332,0.980450,0.183773,0.381232;
	 0.648094,0.082111,0.445748,0.281525,0.666667,0.950147,0.841642,0.627566,0.043011,0.185728,0.358749,0.818182,0.249267,0.665689,0.126100,0.551320,0.350929,0.074291,0.674487,0.926686,0.505376,0.780059,0.194526,0.677419,0.010753,0.289345,0.945259,0.076246,0.727273,0.624633,0.774194,0.503421;
	 0.805474,0.345064,0.981427,0.559140,0.168133,0.470186,0.092864,0.298143,0.427175,0.865103,0.721408,0.009775,0.988270,0.419355,0.852395,0.275660,0.961877,0.441838,0.832845,0.269795,0.031281,0.587488,0.332356,0.844575,0.545455,0.429130,0.788856,0.493646,0.248289,0.042033,0.299120,0.138807;
	 0.588465,0.204301,0.730205,0.056696,0.801564,0.348974,0.691105,0.769306,0.910068,0.260020,0.458456,0.564027,0.323558,0.179863,0.626588,0.040078,0.708700,0.171065,0.609971,0.383187,0.722385,0.881720,0.460411,0.134897,0.899316,0.213099,0.641251,0.353861,0.878788,0.816227,0.468231,0.943304;
	 0.008798,0.857283,0.512219,0.403715,0.930596,0.574780,0.197458,0.513196,0.143695,0.599218,0.100684,0.833822,0.756598,0.481916,0.927664,0.369501,0.781036,0.517107,0.103617,0.977517,0.228739,0.078201,0.668622,0.272727,0.737048,0.059629,0.989247,0.121212,0.570870,0.200391,0.658847,0.373412;
	 0.454545,0.273705,0.643206,0.123167,0.240469,0.853372,0.027370,0.990225,0.391007,0.676442,0.941349,0.233627,0.139785,0.690127,0.096774,0.580645,0.241447,0.888563,0.327468,0.763441,0.555230,0.410557,0.947214,0.595308,0.393939,0.521017,0.314761,0.709677,0.417400,0.913978,0.106549,0.740958;
	 0.158358,0.889541,0.782014,0.321603,0.713587,0.426197,0.632454,0.315738,0.813294,0.046921,0.296188,0.439883,0.870968,0.543500,0.306940,0.817204,0.436950,0.026393,0.654936,0.457478,0.130010,0.811339,0.198436,0.007820,0.918866,0.802542,0.156403,0.858260,0.025415,0.531769,0.338221,0.991202;
	 0.602151,0.528837,0.038123,0.968719,0.495601,0.093842,0.752688,0.225806,0.476051,0.732160,0.554252,0.656891,0.378299,0.006843,0.978495,0.190616,0.697947,0.948192,0.215054,0.851417,0.302053,0.692082,0.492669,0.340176,0.670577,0.242424,0.456500,0.620723,0.292278,0.798631,0.688172,0.229717;
	 0.423265,0.119257,0.365591,0.616813,0.177908,0.920821,0.534702,0.873900,0.159335,0.963832,0.086022,0.912023,0.167155,0.720430,0.467253,0.603128,0.112414,0.363636,0.514174,0.061584,0.585533,0.992180,0.108504,0.863148,0.563050,0.067449,0.757576,0.966764,0.209189,0.480938,0.081134,0.829912;
	 0.915934,0.771261,0.699902,0.264907,0.815249,0.386119,0.290323,0.005865,0.606061,0.362659,0.216031,0.490714,0.803519,0.326491,0.879765,0.258065,0.842620,0.754643,0.634409,0.923754,0.246334,0.385142,0.743891,0.221896,0.424242,0.905181,0.368524,0.113392,0.583578,0.884653,0.645161,0.284457;
	 0.560117,0.182796,0.956989,0.469208,0.045943,0.558162,0.689150,0.806452,0.425220,0.707722,0.845552,0.280547,0.623656,0.109482,0.549365,0.068426,0.446725,0.293255,0.154448,0.422287,0.784946,0.034213,0.508309,0.631476,0.160313,0.683284,0.300098,0.729228,0.430108,0.174976,0.388074,0.004888;
	 0.486804,0.351906,0.091887,0.644184,0.874878,0.147605,0.993157,0.238514,0.101662,0.902248,0.568915,0.030303,0.761486,0.956012,0.374389,0.687195,0.994135,0.573803,0.894428,0.099707,0.653959,0.871945,0.318671,0.955034,0.808407,0.003910,0.518084,0.940371,0.052786,0.777126,0.995112,0.679374;
	 0.742913,0.838710,0.257087,0.401760,0.749756,0.317693,0.452590,0.661779,0.520039,0.180841,0.347019,0.431085,0.153470,0.488759,0.218964,0.809384,0.029326,0.196481,0.717498,0.475073,0.285435,0.556207,0.141740,0.448680,0.260997,0.578690,0.856305,0.222874,0.474096,0.598240,0.328446,0.226784;
	 0.064516,0.581623,0.909091,0.500489,0.193548,0.608993,0.073314,0.773216,0.295210,0.952102,0.794721,0.663734,0.916911,0.726295,0.312805,0.630499,0.407625,0.533724,0.331378,0.837732,0.212121,0.770283,0.897361,0.072336,0.714565,0.398827,0.136852,0.667644,0.288368,0.826002,0.120235,0.890518;
	 0.357771,0.161290,0.673509,0.017595,0.819159,0.935484,0.397849,0.877810,0.002933,0.592375,0.114370,0.255132,0.544477,0.044966,0.868035,0.128055,0.938416,0.766373,0.095797,0.957967,0.022483,0.681329,0.339198,0.516129,0.996090,0.796676,0.336266,0.931574,0.084066,0.719453,0.421310,0.536657;
	 0.768328,0.438905,0.953079,0.305963,0.550342,0.131965,0.244379,0.496579,0.693060,0.360704,0.473118,0.860215,0.395894,0.203324,0.590420,0.471163,0.252199,0.662757,0.377322,0.506354,0.608016,0.414467,0.149560,0.597263,0.207234,0.032258,0.619746,0.494624,0.864125,0.565005,0.202346,0.967742;
	 0.047898,0.593353,0.237537,0.787879,0.382209,0.725318,0.621701,0.836755,0.201369,0.964809,0.760508,0.065494,0.702835,0.997067,0.320626,0.840665,0.001955,0.891496,0.170088,0.750733,0.262952,0.843597,0.908113,0.705767,0.283480,0.455523,0.736070,0.188661,0.379277,0.000978,0.664712,0.282502;
	 0.839687,0.711632,0.116325,0.482893,0.063539,0.998045,0.313783,0.050831,0.447703,0.125122,0.294233,0.633431,0.509286,0.145650,0.746823,0.639296,0.432063,0.557185,0.304008,0.999022,0.104594,0.483871,0.043988,0.372434,0.939394,0.831867,0.124145,0.959922,0.265885,0.783969,0.914956,0.497556;
	 0.178886,0.400782,0.893451,0.650049,0.847507,0.162268,0.522972,0.669599,0.901271,0.577713,0.828935,0.217009,0.882698,0.371457,0.071359,0.232649,0.812317,0.087977,0.701857,0.394917,0.636364,0.214076,0.791789,0.569892,0.086999,0.532747,0.412512,0.649071,0.571848,0.443793,0.105572,0.347996;
	 1.000000,0.541544,0.301075,0.205279,0.562072,0.416422,0.792766,0.247312,0.392962,0.745846,0.344086,0.000000,0.449658,0.607038,0.949169,0.504399,0.355816,0.933529,0.150538,0.826979,0.540567,0.922776,0.319648,0.678397,0.250244,0.772239,0.310850,0.051808,0.850440,0.166178,0.744868,0.628543;];
	
else
   coe=[236 200 249 131 245 209 250 173 206 218 147 184 243 213 199 250 226 151 221 235 186 205 130 213 114 245 172 216 253 171 214 169 223 209 178 237 188 247 233 187 210 231 175 209 242 167 249 165 239 199 250 213 141 253 165 241 190 251 162 185 215 246 174 151 88 229 122 216 230 177 214 226 244 167 249 195 223 151 234 175 161 239 167 195 243 223 234 249 220 101 236 191 207 194 247 235 197 245 218 198 228 155 204 223 250 184 237 123 202 222 211 232 181 147 229 179 226 152 231 156 200 218 228 243 145 227 165 244 214 210 242 144 204 235 198 132 233 200 126 231 142 246 219 205 231 181 248 218 210 192 121 201 127 228 182 224 243 221 131 213 165 226 132 249 213 207 242 195 153 213 162 251 158 235 184 198 252 223 204 246 123 238 117 214 244 178 194 157 235 201 220 105 248 118 197 252 219 105 247 223 159 221 239 158 216 122 156 252 214 191 207 237 134 253 226 212 241 118 251 211 190 175 233 118 252 206 232 190 151 253 149 217 245 230 190 180 226 194 245 217 86 176 242 191 218 173 249 161 233 208 248 212 181 253 170 233 195 237 222 202 155 240 208 129 253 169 203 251 177 241 226 141 173 244 157 189 228 145 198 246 188 232 169 200 230 249 104 238 217 192 173 240 221 234 199 227 182 91 241 216 206 240 83 228 207 235 212 129 232 139 222 205 169 221 85 224 238 158 223 206 227 190 148 239 228 164 217 232 179 213 236 187 228 190 162 242 199 170 215 250 153 240 217 137 223 102 218 239 185 208 220 129 196 225 243 144 184 210 141 239 156 221 177 247 174 203 231 153 248 134 220 251 159 241 197 236 252 105 242 159 188 216 240 136 210 251 225 212 172 249 181 206 242 225 194 220 201 248 211 221 235 209 232 143 221 135 186 235 154 252 162 214 244 127 242 211 248 80 208 216 229 246 219 188 252 233 187 197 224 253 182 215 202 237 199 119 216 227 172 211 167 226 141 231 250 199 163 246 187 199 142 245 159 215 237 191 211 176 245 140 238 193 230 185 167 246 164 202 239 211 248 192 182 237 225 199 93 229 149 227 200 236 141 251 194 74 204 236 198 171 214 237 209 191 221 243 132 225 148 244 189 131 247 219 182 245 194 209 147 229 207 221 243 232 220 205 230 182 134 248 227 198 232 209 216 178 205 253 219 194 223 251 131 230 95 242 222 203 152 247 219 117 253 190 222 147 233 170 209 226 248 139 212 228 249 143 230 165 239 196 211 250 183 230 115 234 165 239 201 144 174 238 218 171 236 161 203 180 196 253 147 244 221 200 144 252 189 172 250 224 240 159 176 237 173 215 205 170 227 213 140 249 210 160 236 193 207 240 76 250 175 218 241 196 151 223 244 117 202 208 246 201 214 158 234 135 223 200 253 152 222 91 230 251 224 85 247 202 252 217 248 214 235 107 218 125 208 236 223 204 218 235 196 208 183 214 229 206 245 189 234 244 190 174 233 156 228 217 198 232 216 155 231 166 214 245 184 213 232 206 193 217 234 132 219 152 252 227 189 218 242 180 217 194 248 214 148 198 153 234 185 211 158 193 169 226 129 242 117 233 250 161 170 243 182 226 128 244 233 111 249 182 225 199 217 99 220 253 207 104 241 134 251 143 246 212 197 224 189 201 238 150 253 168 241 184 251 197 240 225 172 204 247 197 210 237 203 229 67 208 236 243 213 169 227 242 223 233 207 239 195 134 224 199 137 216 230 211 195 247 213 200 148 222 172 210 240 155 250 204 238 148 215 245 169 211 223 204 191 242 152 252 235 221 131 229 216 127 227 173 222 211 150 183 242 213 185 232 87 188 246 179 241 225 190 87 220 253 197 176 201 188 251 173 228 249 186 240 207 246 173 239 180 221 190 230 251 186 242 193 220 188 232 150 121 231 179 225 202 234 186 238 226 94 220 192 133 203 249 166 208 235 157 245 191 231 248 217 167 236 115 222 251 220 201 212 172 150 250 231 142 206 235 215 246 220 198 213 190 156 217 90 227 83 214 198 253 203 237 156 217 163 228 159 252 201 132 195 247 162 192 239 147 252 151 213 89 248 137 239 211 231 188 219 247 134 213 205 237 180 210 129 229 153 245 99 207 127 227 252 233 217 53 183 211 241 155 192 230 135 237 225 245 206 232 252 111 221 235 176 225 187 210 245 205 238 129 213 235 180 243 158 209 172 249 177 207 221 200 244 219 150 228 199 246 143 240 206 193 225 252 99 220 105 239 158 253 107 225 191 231 240 108 196 134 164 239 223 247 139 219 249 185 209 181 194 138 236 165 213 202 243 148 248 172 232 194 220 184 154 248 144 224 138 216 187 236 198 185 214 232 141 229 164 188 234 209 186 215 198 223 175 243 200 187 229 162 250 204 221 163 216 157 249 186 170 215 238 221 245 201 73 191 228 163 204 224 244 210 253 219 152 247 135 229 189 219 158 201 242 179 250 226 235 149 199 246 206 193 251 204 241 228 130 246 182 250 126 241 170 253 225 237 131 251 161 233 147 219 241 207 224 132 233 171 243 234 205 213 224 248 143 209 129 226 251 150 238 188 233 160 216 231 164 178 230 171 239 163 251 197 234 216 228 200 214 107 207 218 232 177 239 230 166 222 155 211 197 235 158 192 224 180 218 197 165 203 230 217 196 155 248 170 215 190 236 197 246 226 210 194 116 242 165 204 229 193 234 185 198 217 170 252 96 240 72 174 222 243 212 158 223 180 215 209 245 181 189 240 117 243 156 253 192 221 188 214 197 244 191 253 225 171 220 240 174 247 149 233 213 249 159 173 238 227 209 231 199 245 166 214 139 200 134 252 228 219 199 236 151 253 214 242 158 232 195 221 212 186 248 235 193 182 134 249 167 241 227 174 194 222 252 206 223 176 229 212 105 242 150 250 107 233 216 183 206 243 186 167 215 227 162 245 154 207 221 244 205 167 193 253 174 222 203 251 220 240 232 215 149 173 250 159 223 169 141 202 219 245 183 237 136 229 88 141 251 226 234 81 220 117 192 238 230 203 178 236 170 246 204 189 234 179 227 115 220 139 201 238 218 178 231 252 152 239 211 171 226 235 168 182 224 246 218 202 237 164 230 189 176 206 191 129 244 208 233 212 176 240 227 249 167 204 225 200 246 181 220 214 199 87 176 246 173 233 253 211 186 247 212 193 217 198 238 219 248 215 194 240 204 247 229 112 249 137 214 94 222 166 205 250 188 202 252 214 198 187 233 100 213 249 195 239 212 248 223 237 160 142 221 195 246 133 184 67 236 63 250 118 217 206 244 190 228 242 218 137 215 166 206 115 226 172 221 249 232 185 210 174 183 200 252 124 225 131 213 196 209 237 149 234 176 243 230 183 218 241 195 229 240 209 156 243 110 219 208 170 226 197 181 217 193 247 183 239 188 216 231 174 222 213 150 230 193 238 160 249 185 204 170 237 225 248 83 243 191 236 151 201 131 226 251 196 239 142 231 211 108 236 75 251 227 174 246 208 224 191 213 199 237 117 210 166 185 250 222 204 235 133 229 244 186 241 204 253 210 178 201 144 226 123 252 192 244 159 239 208 253 129 224 149 236 212 252 164 178 202 231 163 177 159 245 102 241 192 180 213 96 206 119 245 203 243 222 201 187 221 159 186 253 179 247 223 193 220 246 232 216 123 228 169 212 252 183 162 221 134 231 128 189 236 219 251 157 241 172 218 202 228 171 189 222 183 211 196 221 140 229 214 240 221 194 209 251 204 166 228 158 221 243 229 247 162 235 152 217 175 190 234 211 241 231 217 202 236 207 175 249 204 181 192 89 239 199 247 154 225 202 234 179 250 199 214 245 149 213 191 233 197 211 235 92 248 215 242 203 233 246 232 130 241 126 200 190 250 175 238 149 187 234 130 253 178 211 80 195 209 182 198 253 230 206 248 178 199 148 244 131 219 197 228 186 234 215 227 253 207 148 218 237 177 216 246 211 187 235 161 195 170 243 168 223 205 247 179 225 106 176 227 180 217 173 209 251 193 172 245 148 211 228 198 213 243 172 218 206 232 201 236 223 250 226 238 149 195 219 185 216 250 205 226 194 251 162 242 209 190 244 156 197 221 242 189 166 251 192 181 228 201 220 241 208 230 147 249 190 238 187 214 124 241 200 252 155 239 162 226 178 219 237 185 203 235 189 247 135 220 207 248 197 133 245 177 204 176 190 215 208 246 135 242 94 193 238 210 123 233 211 221 178 231 202 213 236 170 226 211 232 205 223 239 196 248 145 184 252 174 217 200 229 177 220 232 250 96 219 133 212 186 247 197 231 210 191 216 253 181 219 151 236 145 230 164 225 237 217 194 241 228 202 242 181 224 152 198 212 228 183 176 240 174 115 237 196 252 131 247 151 206 249 195 184 244 136 209 133 215 233 212 197 222 238 143 211 253 195 204 182 231 175 245 224 235 206 150 249 138 244 133 227 198 242 215 96 252 104 240 84 212 156 252 214 159 248 196 232 158 237 177 252 81 222 249 192 203 246 182 218 205 224 187 229 217 179 235 219 199 230 186 253 149 73 240 227 182 206 246 167 225 119 240 221 114 237 184 204 181 220 240 202 222 208 233 165 206 231 155 226 107 223 157 250 136 235 220 191 209 222 166 211 251 107 223 133 235 150 170 232 166 199 92 244 160 238 208 158 241 190 203 252 88 242 124 192 218 245 177 191 250 216 172 236 153 244 213 125 249 140 191 230 253 194 213 166 239 128 180 247 214 194 249 209 239 176 214 172 227 207 150 231 239 80 236 221 199 214 240 203 218 245 209 180 253 122 230 116 220 147 251 222 169 246 152 224 191 182 207 238 131 143 210 234 202 140 228 208 218 164 151 234 172 217 243 215 155 227 246 178 217 252 224 116 237 71 221 191 150 246 234 188 244 182 247 198 183 253 194 154 244 184 172 247 186 144 226 96 235 184 144 249 175 232 164 200 231 172 198 234 209 247 221 154 231 224 249 155 220 242 149 248 79 227 252 207 146 229 168 93 238 174 159 230 205 193 141 229 159 251 156 232 217 184 110 222 204 218 202 226 212 219 204 230 207 227 217 151 230 178 242 187 221 206 240 214 159 243 212 237 155 211 240 122 228 196 180 251 159 141 198 237 205 161 232 108 239 112 183 223 246 194 186 251 148 210 220 250 176 236 210 243 204 169 199 242 152 253 210 238 91 251 105 243 192 235 169 246 189 250 181 234 171 251 169 198 248 156 224 168 204 227 154 196 253 223 135 249 170 213 236 89 217 244 214 176 252 213 187 222 144 216 241 209 163 236 214 120 207 234 152 191 216 245 162 219 181 235 223 164 228 196 216 125 230 167 224 208 134 248 215 197 225 167 202 239 193 222 205 229 201 237 194 252 234 173 247 218 183 206 226 73 219 243 191 229 131 233 136 227 191 224 245 168 250 118 232 199 226 149 248 197 242 172 244 232 203 189 227 197 248 133 212 245 207 139 248 233 209 242 145 234 200 221 161 233 130 241 220 164 212 243 190 238 183 210 219 181 217 207 191 235 198 244 128 238 148 182 208 246 197 220 194 241 140 200 235 211 138 220 180 253 140 239 169 219 162 224 213 148 223 253 165 239 208 231 176 162 240 225 201 156 186 215 199 250 118 240 115 252 172 187 153 253 184 226 179 216 250 175 244 228 197 241 225 181 216 230 185 215 252 232 222 158 209 253 125 160 247 207 173 230 190 244 147 224 193 127 229 204 252 97 160 238 156 201 211 221 185 155 252 219 183 151 236 220 252 229 184 218 206 228 213 164 223 245 229 173 236 203 246 155 223 130 214 152 248 179 201 251 209 172 248 156 195 201 163 240 226 103 223 236 148 219 251 150 238 171 208 235 206 246 188 233 166 227 249 209 229 242 154 247 132 238 188 153 228 249 205 164 211 171 237 192 245 136 195 238 191 134 194 218 209 121 233 186 207 235 112 231 188 212 233 177 237 189 224 123 235 152 250 78 199 243 151 169 229 159 197 226 162 195 249 217 136 222 201 211 241 177 221 175 205 191 234 180 226 199 173 244 126 200 222 243 179 246 203 224 182 232 249 208 231 214 240 182 248 221 71 227 242 154 253 162 222 239 107 220 141 241 151 245 179 205 167 218 232 95 216 249 213 240 205 246 210 228 144 202 240 196 250 113 217 93 122 235 251 219 214 204 250 178 231 215 191 235 182 197 226 214 188 253 210 198 217 162 125 251 189 225 202 110 252 180 193 204 217 199 246 143 208 249 169 221 136 214 132 239 192 247 131 207 237 171 202 177 222 189 140 243 214 232 154 226 158 231 163 246 182 213 189 159 244 171 224 206 241 184 221 247 212 232 65 240 102 220 94 236 190 243 223 141 210 238 153 231 160 211 245 224 237 173 211 193 231 149 228 157 253 234 200 182 213 157 224 252 195 220 244 232 199 253 225 200 149 252 181 244 199 237 174 225 242 228 202 232 197 236 187 229 193 253 175 208 188 251 204 145 230 200 244 212 227 155 175 247 220 196 244 217 187 236 139 201 183 240 226 252 216 187 244 212 198 188 225 251 169 236 203 153 228 181 211 191 236 121 208 235 193 220 205 168 183 208 253 198 161 194 248 179 218 167 246 170 214 198 234 196 228 129 218 248 207 235 158 166 252 199 234 164 184 229 178 200 249 220 196 250 219 207 190 181 201 235 205 180 229 243 177 207 222 149 245 215 241 198 250 115 217 242 153 218 248 147 239 223 247 217 178 220 210 238 222 207 252 212 146 223 239 179 219 245 177 238 171 224 161 197 222 239 107 217 67 237 215 253 206 233 137 208 228 169 230 108 247 223 242 174 219 248 191 217 210 241 161 230 191 133 208 125 223 231 204 126 229 167 197 230 175 211 140 229 166 234 250 133 185 142 226 128 243 205 190 249 203 187 217 194 155 242 215 250 189 135 225 187 249 155 202 183 223 194 240 173 243 205 182 236 198 214 178 227 156 237 203 171 232 195 248 205 220 253 226 237 147 155 246 214 251 210 240 203 249 195 236 156 245 155 171 215 231 240 162 209 233 130 221 232 141 241 172 252 227 202 175 233 209 246 116 232 208 228 241 211 246 163 214 222 191 216 248 210 160 233 167 250 213 185 224 252 175 219 105 235 156 211 114 201 248 207 221 118 200 157 222 148 213 227 187 216 182 224 206 244 190 176 247 218 173 251 181 212 206 160 201 213 183 245 167 221 186 229 213 242 192 182 218 108 201 235 181 252 166 232 164 225 253 204 239 196 115 246 166 113 238 169 227 200 244 196 240 218 103 234 146 239 226 245 192 234 185 243 207 252 199 241 140 228 203 216 235 144 227 139 237 158 248 223 236 193 231 208 238 196 253 160 201 138 222 251 198 244 225 189 227 149 213 242 203 189 218 176 209 222 234 182 218 231 160 203 250 164 214 225 182 230 213 192 252 197 112 216 205 253 218 201 111 232 153 220 213 175 253 188 209 197 242 215 171 229 128 197 180 250 178 220 157 226 204 219 247 234 207 165 230 102 210 250 205 238 174 197 231 245 195 227 244 186 202 249 199 179 245 221 82 233 147 251 209 189 245 203 223 212 233 139 229 176 191 238 225 212 193 247 100 234 167 238 222 250 179 161 246 208 218 243 216 205 240 199 249 189 236 156 211 195 113 238 216 192 236 172 218 141 247 115 207 143 237 200 154 229 216 177 240 226 196 145 241 159 217 170 238 198 177 236 164 180 248 166 241 211 246 182 196 250 202 230 243 205 219 181 202 186 225 236 178 165 253 188 232 186 224 121 217 93 244 198 240 169 252 174 196 248 220 200 241 194 188 212 251 221 131 215 252 192 238 190 211 176 253 168 223 127 246 179 220 249 227 206 243 228 159 219 135 172 221 209 240 128 222 115 224 137 248 91 244 127 212 150 221 234 211 163 203 246 166 235 154 229 191 215 227 124 213 162 229 118 186 253 171 228 126 235 202 122 241 116 223 208 161 247 126 236 131 229 115 235 135 232 208 191 215 185 168 209 190 237 224 251 179 231 189 215 237 192 210 239 149 208 173 219 252 138 241 156 172 239 145 219 210 252 162 242 152 250 130 232 154 241 176 233 168 223 156 183 244 217 160 230 206 248 146 232 172 204 184 224 189 183 248 149 214 178 242 106 235 253 218 232 250 68 198 143 236 200 249 127 199 252 132 187 226 157 233 201 148 228 116 207 248 182 194 230 198 184 213 149 221 205 160 246 191 218 110 245 189 239 192 232 166 196 249 213 149 226 164 243 214 234 251 153 243 231 218 200 252 226 204 223 200 145 195 151 205 215 243 213 186 226 181 229 176 218 233 143 251 67 246 111 240 166 249 215 227 114 251 126 241 226 233 247 188 235 211 223 159 249 182 221 214 179 247 173 201 236 220 157 239 118 219 182 198 180 217 194 208 163 193 239 161 212 147 248 112 229 245 222 240 84 227 140 246 217 151 242 190 245 156 213 197 236 182 221 188 217 161 198 149 237 139 206 190 215 180 165 224 176 253 194 237 207 228 188 251 199 225 208 252 182 193 231 138 253 170 236 249 228 187 238 222 250 210 221 186 230 241 160 238 167 189 202 103 252 201 235 155 193 253 208 223 185 248 228 166 216 147 229 247 203 232 243 220 202 233 222 245 172 249 209 238 198 216 102 226 144 242 155 212 235 176 190 222 240 205 246 212 109 222 210 191 139 245 173 199 120 233 128 246 153 216 182 221 177 249 233 212 220 134 222 207 232 211 146 234 204 220 150 243 189 253 199 76 225 129 208 113 246 164 197 185 230 132 187 219 244 133 240 137 219 175 231 195 206 244 230 211 179 219 173 234 207 244 88 230 216 131 227 241 215 134 236 159 225 201 251 206 228 208 186 158 239 183 248 160 241 119 219 240 102 161 239 207 224 120 238 168 241 194 252 214 145 224 253 217 208 242 228 87 200 231 172 152 252 134 222 248 161 218 149 188 250 196 229 192 225 94 240 200 252 203 218 146 198 253 180 204 244 190 234 96 243 115 224 246 198 230 217 204 173 250 158 183 226 186 218 94 232 196 157 222 201 235 123 228 238 204 143 236 70 170 179 251 107 215 247 229 193 238 187 203 233 89 239 227 203 241 185 251 202 215 101 220 141 238 191 247 224 192 229 214 177 220 143 218 154 236 203 214 139 210 83 237 224 168 231 212 252];
coe=vec2mat(coe,64)/255;
end
      
coe_min=min(min(coe));
coe_max=max(max(coe));


for y=1:bs:s1
    for x=1:bs:s2
        
        mx=max(max(im(y:(y+bs-1),x:(x+bs-1))));
        mn=min(min(im(y:(y+bs-1),x:(x+bs-1))));
        k=mx-mn;
        
        Num=coe-coe_min;
        DA=k*Num;
        DA=DA+mn;
        
        bl=im(y:(y+bs-1),x:(x+bs-1));
        M=(bl>=DA).*mx;
        N=(bl<DA).*mn;
        Y1(y:(y+bs-1),x:(x+bs-1))=M+N;
    end
end
 Y1=uint8(255 * mat2gray(Y1));
end
